<nav class="navbar navbar-expand-lg navbar-light bg-light">
  <div class="container-fluid">

    <!-- Brand -->
    <a class="navbar-brand me-2 mb-1 d-flex align-items-center" [routerLink]="'/'">
      <img src="https://fireloc.org/wp-content/uploads/2019/12/FireLOC-200.png" alt="" loading="lazy" />
    </a>

    <!-- Small Screen Hamburger Button -->
    <button class="navbar-toggler" type="button" (click)="isCollapsed = !isCollapsed">
      &#9776;
    </button>

    <!-- Navbar links collapsable -->
    <div [ngbCollapse]="isCollapsed" class="collapse navbar-collapse">
      <ul ngbNav class="navbar-nav ml-auto" [class]="isCollapsed ? '' : 'nav-collapsed' ">

        <!-- Backoffice -->
        <li class="nav-item" *ngIf="isLoggedIn && hasPermission">
          <a class="nav-link backoffice" routerLink="/admin">Backoffice</a>
        </li>

        <!-- Links from constants -->
        <span *ngFor="let link of navLinks">
          <li class="nav-item">
            <!-- Internal Links (Portuguese & English) -->
            <ng-container *ngIf="link.internal && selectedLanguage.country === 'pt'">
              <a class="nav-link" routerLink="{{link.redirectPT}}" (click)="isCollapsed = true">{{ link.titlePT }}</a>
            </ng-container>
            <ng-container *ngIf="link.internal && selectedLanguage.country === 'gb'">
              <a class="nav-link" routerLink="{{link.redirectEN}}" (click)="isCollapsed = true">{{ link.titleEN }}</a>
            </ng-container>
            <!-- External Links (Portuguese & English) -->
            <ng-container *ngIf="!link.internal && selectedLanguage.country === 'pt'">
              <a class="nav-link" href="{{link.redirectPT}}" target="_blank" (click)="isCollapsed = true">{{
                link.titlePT }}</a>
            </ng-container>
            <ng-container *ngIf="!link.internal && selectedLanguage.country === 'gb'">
              <a class="nav-link" href="{{link.redirectEN}}" target="_blank" (click)="isCollapsed = true">{{
                link.titleEN }}</a>
            </ng-container>
          </li>
        </span>

        <!-- Login -->
        <li class="nav-item" *ngIf="!isLoggedIn">
          <a class="nav-link login" (click)="openLogin()">Log In</a>
        </li>

        <!-- Logout -->
        <li class="nav-item" *ngIf="isLoggedIn">
          <a class="nav-link login" (click)="logout()">Log Out</a>
        </li>

        <!-- User Profile -->
        <div ngbDropdown class="profile-nav d-inline-block" *ngIf="isLoggedIn">
          <button id="userProfile" ngbDropdownToggle>
            <img src="../../../assets/images/profile/profile-default.png" alt="user">
          </button>

          <!-- User Profile Dropdown -->
          <div ngbDropdownMenu class="profile-dropdown dropdown-menu dropdown-menu-lg-end">
            <div class="profile-menu-container d-flex flex-column">

              <!-- Main Information -->
              <div class="main-profile d-flex justify-content-center align-items-center">
                <img src="../../../assets/images/profile/profile-default.png" alt="user">

                <div class="d-flex flex-column">
                  <p id="profile-name">{{userName}}</p>
                  <p id="profile-email">{{userEmail}}</p>
                  <button class="edit-button btn btn-secondary" routerLink="/profile">
                    {{ 'PROFILE.Edit' | translate }}
                  </button>
                </div>
              </div>

              <!-- See Contributions -->
              <div class="contrib d-flex" routerLink="/profile/contributions">
                <fa-icon [icon]="listIcon"></fa-icon>
                <p>{{ 'PROFILE.Contribs' | translate }}</p>
              </div>

              <!-- Change Password -->
              <div class="change-password d-flex" routerLink="/profile/password">
                <fa-icon [icon]="passwordIcon"></fa-icon>
                <p>{{ 'PROFILE.ChangePass' | translate }}</p>
              </div>

              <!-- Logout -->
              <div class="logout d-flex" (click)="logout()">
                <fa-icon [icon]="logoutIcon"></fa-icon>
                <p>{{ 'PROFILE.Leave' | translate }}</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Languages -->
        <div ngbDropdown class="nav-languages d-inline-block">
          <button class="btn btn-light" id="langSelect" ngbDropdownToggle>
            <span class="flag-icon flag-icon-{{selectedLanguage.country}}"></span>
            {{selectedLanguage.language}}
          </button>
          <div ngbDropdownMenu class="lang-dropdown dropdown-menu dropdown-menu-lg-end">
            <button *ngFor="let language of navLanguages" ngbDropdownItem [value]="language.country"
              (click)="selectLanguage(language)">
              <span class="flag-icon flag-icon-{{language.country}}"></span>
              {{ language.language }}
            </button>
          </div>
        </div>
      </ul>
    </div>
  </div>
</nav>